<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
    <title>TrashLocator</title>
    <style type="text/css">
        body,
        html {
            height: 100%;
            width: 100%;
            margin: 0;
        }
        div.wrapper {
            /* Outer infowindow size */
            width: 317px;
            height: 252px;
            margin: 6px;
            display: none;
        }
        div.tabs {
            /* Tabs container */
            position: relative;
            bottom: 35px;
            left: -18px;
            /*  height: 2px; */
            display: table;
        }
        span.activeTab,
        span.passiveTab,
        span.hoverTab {
            float: left;
            height: 19px;
            border-top: 1px solid #8fA7cc;
            border-right: 1px solid #8fA7cc;
            border-left: 1px solid #8fA7cc;
            /* Default inner spaces for all tabs */
            padding: 1px 7px;
            /* Rounded corners for all tabs */
            -moz-border-radius-topleft: 8px;
            -moz-border-radius-topright: 8px;
            -webkit-border-top-left-radius: 8px;
            -webkit-border-top-right-radius: 8px;
            border-top-left-radius: 8px;
            border-top-right-radius: 8px;
            /* Adjust box-shadow of tabs to infowindow */
            box-shadow: -2px -2px 2px rgba(0, 0, 0, 0.05);
            /* Avoid selecting text on tab click */
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
        }
        span.activeTab {
            /* Increase height of active tab */
            position: relative;
            bottom: 2px;
            height: 20px;
            padding-top: 3px;
            font-weight: bold !important;
            color: #5D5CA0;
            background-color: #FFF;
        }
        *span.activeTab {
            /* IE fix */
            zoom: 1;
        }
        iframe#myvideo {
            width: 317px !important;
            height: 225px !important;
            display: inherit;
        }
        span.passiveTab {
            cursor: default;
            color: #006;
            background-color: #E9E9E9;
        }
        span.hoverTab {
            cursor: pointer;
            color: #5676EA;
            background-color: #DCDCDC;
        }
        div.cardContent {
            /* Inner infowindow size */
            position: relative;
            top: -18px;
            width: 317px;
            height: 229px;
            padding: 4px 5px 0 0;
            overflow-y: auto;
            display: none;
        }
        .controls {
            margin-top: 16px;
            border: 1px solid transparent;
            border-radius: 2px 0 0 2px;
            box-sizing: border-box;
            -moz-box-sizing: border-box;
            height: 32px;
            outline: none;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.3);
        }
        #pac-input {
            background-color: #fff;
            padding: 0 11px 0 13px;
            width: 400px;
            font-family: Roboto;
            font-size: 15px;
            font-weight: 300;
            text-overflow: ellipsis;
        }
        #pac-input:focus {
            border-color: #4d90fe;
            margin-left: -1px;
            padding-left: 14px;
            /* Regular padding-left + 1. */
            width: 401px;
        }
        .pac-container {
            font-family: Roboto;
        }
        #type-selector {
            color: #fff;
            background-color: #4d90fe;
            padding: 5px 11px 0px 11px;
        }
        #target {
            width: 345px;
        }
        #type-selector label {
            font-family: Roboto;
            font-size: 13px;
            font-weight: 300;
            b {
                /* Use !important to overwrite API injections in infowindows */
                font-weight: bold !important;
            }
    </style>
    <script src="https://maps.googleapis.com/maps/api/js?v=3.exp&sensor=false&libraries=places"></script>
    <script type="text/javascript">
        var geocoder = new google.maps.Geocoder();

        function geocodePosition(pos) {
            geocoder.geocode({
                latLng: pos
            }, function (responses) {
                if (responses && responses.length > 0) {
                    updateMarkerAddress(responses[0].formatted_address);
                } else {
                    updateMarkerAddress('Cannot determine address at this location.');
                }
            });
        }

        function updateMarkerAddress(str) {
            document.getElementById('address').innerHTML = str;
        }

        function GeoLocation(controlDiv, map) {

            controlDiv.style.padding = '5px';

            // Set CSS for the control border
            var controlUI = document.createElement('div');
            controlUI.style.backgroundColor = 'white';
            controlUI.style.borderStyle = 'solid';
            controlUI.style.borderWidth = '1px';
            controlUI.style.cursor = 'pointer';
            controlUI.style.textAlign = 'center';
            controlUI.title = 'Click to place a marker at your current position';
            controlDiv.appendChild(controlUI);

            // Set CSS for the control interior
            var controlText = document.createElement('div');
            controlText.style.fontFamily = 'Arial,sans-serif';
            controlText.style.fontSize = '12px';
            controlText.style.paddingLeft = '4px';
            controlText.style.paddingRight = '4px';
            controlText.innerHTML = '<b>Current Location</b>';
            controlUI.appendChild(controlText);

            // Will call place marker to place marker at geolocation
            google.maps.event.addDomListener(controlUI, 'click', function () {

            });

        }


        var map, infowindow, player;
        var msie = (document.all) ? 1 : 0;

        function TabCard(a, b, c) {
            this.tabid = a;
            this.cardid = b;
            this.handleTabs = handleTabs;
            this.point = c;
            this.handleTabs(1)
        }

        function handleTabs(c) {
            var d = this;
            var e = document.getElementById(this.tabid);
            this.newcard = this.cardid + c;
            if (!this.card) this.card = this.newcard;
            document.getElementById(this.card).style.display = "none";
            document.getElementById(this.newcard).style.display = "block";
            this.card = this.newcard;
            for (var i = 0, tab; tab = e.getElementsByTagName("span")[i]; i++) {
                if (tab.getAttribute("data-name") * 1 == c) {
                    tab.className = "activeTab";
                    tab.onmouseover = null;
                    tab.onmouseout = null;
                    tab.onclick = null
                } else {
                    tab.className = "passiveTab";
                    tab.onmouseover = function () {
                        this.className = "hoverTab"
                    };
                    tab.onmouseout = function () {
                        this.className = "passiveTab"
                    };
                    tab.onclick = function () {
                        var a = this.getAttribute("data-name") * 1;
                        var b = this.firstChild.nodeValue;
                        d.handleTabs(a);
                        if (a == 5) viewStreet(d.card, d.point);
                        else if (b == "Mini Map") seeMiniMap(d.card, d.point);
                        else if (b == "Video") showVideo(d.card);
                        if (a != 6) {
                            if (msie) removeVideo();
                            else if (player) player.pauseVideo()
                        }
                        return false
                    }
                }
            }
        }

        function viewStreet(a, b) {
            var g = google.maps;
            var c = new g.StreetViewPanorama(document.getElementById(a), {
                position: b
            });
            c.setVisible(true)
        }

        function seeMiniMap(a, b) {
            var g = google.maps;
            var c = new g.Map(document.getElementById(a), {
                center: b,
                zoom: 18,
                streetViewControl: false,
                mapTypeId: "hybrid",
                mapTypeControlOptions: {
                    style: g.MapTypeControlStyle.DROPDOWN_MENU
                }
            })
        }

        var markers = [];

        function createMarker(position, b) {
            var marker = new google.maps.Marker({
                position: position,
                map: map,
                clickable: true,
                draggable: true
            });
            markers.push(marker);
            google.maps.event.addListener(marker, "click", function () {
                infowindow.setContent(b);
                b.style.display = "block";
                infowindow.open(map, this)
                geocodePosition(marker.getPosition());
            });
            google.maps.event.addListener(marker, 'dragstart', function () {
                updateMarkerAddress('Dragging...');
            });

            google.maps.event.addListener(marker, 'dragend', function () {
                geocodePosition(marker.getPosition());
            });
            return marker
        }

        function buildMap() {
            var minZoomLevel = 11;
            var maxZoomLevel = 17;

            var mapOptions = {
                center: new google.maps.LatLng(40.714353, -74.005973),
                zoom: 11,
                mapTypeId: "roadmap",
                streetViewControl: false,
                mapTypeControlOptions: {
                    style: google.maps.MapTypeControlStyle.DEFAULT,
                    mapTypeIds: [google.maps.MapTypeId.ROADMAP]
                }
            };
            map = new google.maps.Map(document.getElementById("map"), mapOptions);
            var strictBounds = new google.maps.LatLngBounds(
                new google.maps.LatLng(40.555026, -74.196167),
                new google.maps.LatLng(40.857448, -73.711395));
            map.fitBounds(strictBounds);

            google.maps.event.addListener(map, 'dragend', function () {
                if (strictBounds.contains(map.getCenter())) return;

                //moves map back into position if dragged out of coordinates
                var c = map.getCenter(),
                    x = c.lng(),
                    y = c.lat(),
                    maxX = strictBounds.getNorthEast().lng(),
                    maxY = strictBounds.getNorthEast().lat(),
                    minX = strictBounds.getSouthWest().lng(),
                    minY = strictBounds.getSouthWest().lat();

                if (x < minX) x = minX;
                if (x > maxX) x = maxX;
                if (y < minY) y = minY;
                if (y > maxY) y = maxY;

                map.setCenter(new google.maps.LatLng(y, x));
            });

            google.maps.event.addListener(map, 'zoom_changed', function () {
                if (map.getZoom() < minZoomLevel) map.setZoom(minZoomLevel);
                if (map.getZoom() > maxZoomLevel) map.setZoom(maxZoomLevel);
            });

            google.maps.event.addListener(map, 'click', function (e) {
                deleteMarkers();
                placeMarker(e.latLng);
            });

            // Create the search box and link it to the UI element.
            var input = /** @type {HTMLInputElement} */
                (
                document.getElementById('pac-input'));
            map.controls[google.maps.ControlPosition.TOP_LEFT].push(input);

            var searchBox = new google.maps.places.SearchBox(
                /** @type {HTMLInputElement} */
                (input));

            // [START region_getplaces]
            // Listen for the event fired when the user selects an item from the
            // pick list. Retrieve the matching places for that item.
            google.maps.event.addListener(searchBox, 'places_changed', function () {
                var places = searchBox.getPlaces();

                for (var i = 0, marker; marker = markers[i]; i++) {
                    marker.setMap(null);
                }

                // For each place, get the icon, place name, and location.
                markers = [];
                var bounds = new google.maps.LatLngBounds();
                //for (var i = 0, place; place = places[i]; i++) {
                //places only first location in queue
                place = places[0]

                //calls placeMarker to place marker
                placeMarker(place.geometry.location)

                //adjusts window
                bounds.extend(place.geometry.location);
                map.fitBounds(bounds);
            });
            // [END region_getplaces]

            // Bias the SearchBox results towards places that are within the bounds of the
            // current map's viewport.
            google.maps.event.addListener(map, 'bounds_changed', function () {
                var bounds = map.getBounds();
                searchBox.setBounds(bounds);
            });

            var geoLocationDiv = document.createElement('div');
            var geoLocation = new GeoLocation(geoLocationDiv, map);


            map.controls[google.maps.ControlPosition.TOP_RIGHT].push(geoLocationDiv);

        }

        function placeMarker(position) {
            infowindow = new google.maps.InfoWindow();
            var d = document.getElementById("wrapper1");
            var e = new TabCard("firstTabs", "firstCard", position);
            var f = createMarker(position, d);
        }

        function setAllMap(map) {
            for (var i = 0; i < markers.length; i++) {
                markers[i].setMap(map);
            }
        }

         // Removes the markers from the map, but keeps them in the array.
        function clearMarkers() {
            setAllMap(null);
        }

         // Deletes all markers in the array by removing references to them.
        function deleteMarkers() {
            clearMarkers();
            markers = [];
        }

        window.onload = buildMap;
    </script>
</head>

<body>
    <input id="pac-input" class="controls" type="text" placeholder="Search Box">
    <div id="map" style="width: 100%; height: 100%;"></div>
    <!-- Tabs of first marker -->
    <div id="wrapper1" class="wrapper">
        <div id="firstTabs" class="tabs">
            <span data-name="1">TrashLocator</span>

            <span data-name="2">Twitter</span>

            <span data-name="3">Facebook</span>

            <span data-name="4">Google+</span>

            <span data-name="5">Street View</span>

            <span data-name="6">Mini Map</span>

        </div>
        <div id="firstCard1" class="cardContent">
            <!-- Content of first tab card -->
            <div id="content">
                <div id="siteNotice"></div>

                <h1 style="text-align:center"> Report Trash </h1>

                <form method="POST" align="center">
                    <b>Closest matching address:</b>

                    <div id="address"></div>
                    <p>Email Address:
                        <input type="text" name="email" value="">
                    </p>
                    <p>Severity of trash: 0
                        <input type="range" name="trash" min="1" max="10">10</p>
                    <p>Attach a photo:
                        <input type="file" name="photo" allow="image/*">
                        <p>
                            <p>
                                <input type="submit" name="button" value="Submit">
                                <input onclick="deleteMarkers();" type=button value="Delete Markers">
                            </p>
                            <br>
                </form>
            </div>
        </div>
        <div id="firstCard2" class="cardContent">
            <div align="center" id="Div1">
                <div id="Div2"></div>

                <h1 style="text-align:center"> Report Trash </h1>

                <p>Below is a sample report posted via Twitter. Please describe the situation in the body of the tweet. Then follow with the hashtag <b>#TrashPickupNYC #(Your Neighborhood) #(Optional: Street Intersection)</b>. You may also upload a photo
                    onto the tweet.</p>
                <blockquote class="twitter-tweet" lang="en">
                    <p>Clean up here please. <a href="https://twitter.com/search?q=%23TrashPickupNYC&amp;src=hash">#TrashPickupNYC</a>

                        <a href="https://twitter.com/search?q=%23Tribeca&amp;src=hash">#Tribeca</a>  <a href="https://twitter.com/search?q=%23345Chambers&amp;src=hash">#345Chambers</a>

                        <a href="http://t.co/wpItU9vf7v">pic.twitter.com/wpItU9vf7v</a>

                    </p>&mdash; NYC Trash Locator (@NYCTrashLocator) <a href="https://twitter.com/NYCTrashLocator/statuses/454624168605007872">April 11, 2014</a>

                </blockquote>
                <script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>
                <br>
                <a href="https://twitter.com/intent/tweet?button_hashtag=TrashPickupNYC" class="twitter-hashtag-button" data-size="large">Tweet #TrashPickupNYC</a>

            </div>
        </div>
        <div id="firstCard3" class="cardContent">
            <div id="Div10"></div>

            <h1 style="text-align:center"> Report Trash </h1>

            <b>Closest matching address:</b>

            <div id="Div11"></div>
            <p>Below is a sample report posted via Facebook. Please describe the situation in the body of the post. Then follow with the hashtag <b>#TrashPickupNYC #(Your Neighborhood) #(Optional: Street Intersection)</b>. You may also upload a photo along
                with the post.
                <p>
                    <div id="fb-root"></div>
                    <script>
                        (function (d, s, id) {
                            var js, fjs = d.getElementsByTagName(s)[0];
                            if (d.getElementById(id)) return;
                            js = d.createElement(s);
                            js.id = id;
                            js.src = "//connect.facebook.net/en_US/all.js#xfbml=1";
                            fjs.parentNode.insertBefore(js, fjs);
                        }(document, 'script', 'facebook-jssdk'));
                    </script>
                    <div class="fb-post" data-href="https://www.facebook.com/photo.php?fbid=1374286702855385&amp;set=a.1374286729522049.1073741827.100008222040193&amp;type=1" data-width="466">
                        <div class="fb-xfbml-parse-ignore"><a href="https://www.facebook.com/photo.php?fbid=1374286702855385&amp;set=a.1374286729522049.1073741827.100008222040193&amp;type=1">Post</a> by <a href="https://www.facebook.com/profile.php?id=100008222040193">Trash Locator</a>.</div>
                    </div>
                    <p>hi</p>
        </div>
        <div id="firstCard4" class="cardContent">
            <div align="center" id="Div13">
                <div id="Div14"></div>

                <h1 style="text-align:center"> Report Trash </h1>

                <p>Below is a sample report posted via Google+. Please describe the situation in the body of the post. Then follow with the hashtag <b>#TrashPickupNYC #(Your Neighborhood) #(Optional: Street Intersection)</b>. You may also upload a photo along
                    with the post.
                    <p>
                        <!-- Place this tag in your head or just before your close body tag. -->
                        <script type="text/javascript" src="https://apis.google.com/js/plusone.js"></script>
                        <!-- Place this tag where you want the widget to render. -->
                        <div class="g-post" data-href="https://plus.google.com/107309753046337293392/posts/Jq4LRxDcuJi"></div>
                        <p>hi</p>
            </div>
        </div>
        <div id="firstCard5" class="cardContent">
            <!-- Street View herein -->
        </div>
        <div id="firstCard6" class="cardContent">
            <!-- Mini Map herein otherwise HTML content -->
        </div>
    </div>
</body>

</html>